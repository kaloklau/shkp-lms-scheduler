(1) finetune SQL to cater for e-gift condition. 